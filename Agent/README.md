# lpi-pinn
Software for the project titled: Accelerated Learning of Physical Interaction Skills with Physics Informed Nets

We have created a set of challenging physical tasks (in Isaac Gym) on which we show the performance of our PINN-GP-UCB agent.

## Installation
Follow the installation process for [Isaac Gym](https://developer.nvidia.com/isaac-gym). We recommend setting up a dedicated conda environment. No other installation is required.

## Activating Environment
Run commands in `activate_env.sh`

## Generating Training Data
Run `python data_generation.py` with specific arguments to generate the data. Various arguments are:

| Argument | Description |
| --- | --- |
| env | Name of the environment to run |
| simulate (bool) | Set True to render the simulation |
| action_params | Dimension of action vector |
| L (int) | Number of contexts generated |
| M (int) | Number of actions per context |
| mode (train, test, dryrun) | Type of experiment running |
| fast | Invoke PINN for fast training |

| Environment Name (internal) | Environment Name (external) | num_action_parameters |
| --- | --- | --- |
| `pendulum` | Launch | 2 |
| `sliding` | Slide | 2 |
| `catapult` | Catapult | 3 |
| `wedge` | Wedge | 2 |
| `bridge` | Bridge | 2 |
| `sliding_bridge` | Slide over Bridge | 3 |
| `paddles` | Guide the Ball | NUM_PADDLES |

Note: Use `data_generation_gpucb.py` to generate data with GP-UCB algorithm (as opposed to random sampling).

## Training Agent Models
Run `python train.py` with specific arguments to train the models. Various arguments are:

| Argument | Description |
| --- | --- |
| env | Name of the environment to run |
| action_params | Dimension of action vector |
| epochs | Number of epochs to train each intermediate model |
| contexts | Total number of contexts to train |
| contexts_step | Number of training contexts after which to save intermediate model |
| fast | Train model on PINN data |

## Evaluating Regret Results
Run `python {phyre_}eval_agent.py` with specific arguments to get regret results. Various arguments are:

| Argument | Description |
| --- | --- |
| env | Name of the environment to run |
| action_params | Dimension of action vector |
| simulate (bool) | Set True to render the simulation |
| model | Name of the agent model to evaluate |
| contexts | Total number of contexts to evaluate |
| actions | Number of actions available for each context |

## Evaluating Action Results (Archived)
Run `python {phyre_}eval_partial_agent.py` with specific arguments to get regret results. Various arguments are:

| Argument | Description |
| --- | --- |
| env | Name of the environment to run |
| action_params | Dimension of action vector |
| simulate (bool) | Set True to render the simulation |
| model | Name of the agent model to evaluate |
| contexts | Total number of contexts to evaluate |
| threshold | Performs actions until regret threshold is achieved |

## MCTS
This is the latest agent design which does not need any training or data generataion. It uses skill composition.

Run `python pinn_mcts_eval_agent.py` with specific arguments to run MCTS algorithm. Various arguments are:

| Argument | Description |
| --- | --- |
| env | Name of the environment to run (Currently works only for `paddles`) |
| action_params | Dimension of action vector |
| simulate (bool) | Set True to render the simulation |
| contexts | Total number of contexts to evaluate |
| actions | Number of actions available for each context |

## Experimentation Techniques
Modify the scripts `data_generate.sh`, `train.sh`, `regret_exp.sh`, and `action_exp.sh` with the specific hyperparameters of the experiment. Stitch everything in `script.sh` and run it. Running all stages will take around 4-5 hours.

## Description of folders
`assets` contains URDFs used by various environments. `environments` contain the fabrications of various environments. `data` will contain training data generated by `data_generation.py`. `agent_models` will contain saved agent model generate by `train.py`. `pinn_models` contain the PINN models used by the environments. Any new PINN model needs to be added here.

Results of the experiments will be saved in `experiments/` with `time_`, `regret_`, `action_` and `mcts_` as prefixes for various stages. Final results can be moved to `stored_results/` for future reference.

## PINN

### Pendulum, Sliding and Projectile
Run `python3 *_driver.py` to train the respective models. Deatils in the README of the PINN/Skills folder.
